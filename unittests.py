import unittest
from LattyMorph.morphing import create_flat_2D_sheet, create_flat_3D_sheet
from LattyMorph.morphing.lattice_models import Toti2D
from LattyMorph.morphing.lattice_models import Toti3D
import torch

class Test2DCreation(unittest.TestCase):

    def test_flat_sheet(self):
        for dimx in [2,6,12]:
            for dimy in [2,6,12]:
                model = create_flat_2D_sheet(dimx,dimy)
            forwardworks = model()
            lengthsOk = model._check_lengths()
            self.assertTrue(forwardworks)
            self.assertTrue(lengthsOk)

    def test_configA(self):
        model = create_flat_2D_sheet(3,3)
        model.config[0][0]['phi'].data[0] = -0.2
        model.config[1][0]['phiPrime'].data[0] = 0.
        model.config[0][0]['theta'].data[0] = 2
        model.config[0][0]['thetaPrime'].data[0] = 1.5
        model.config[1][0]['theta'].data[0] = 1.55
        model.config[-1][0]['theta'].data[0] = 1.2
        model.config[-2][0]['theta'].data[0] = 0.5
        model.forward()
        
        for i in range(3):
            for j in range(3):
                self.assertTrue(
                    (torch.Tensor(testCoordsA[i][j]['pointA']) - model.lattice[i][j].pointA).norm() < 1e-5
                )
                self.assertTrue(
                    (torch.Tensor(testCoordsA[i][j]['pointB']) - model.lattice[i][j].pointB).norm() < 1e-5
                )
                self.assertTrue(
                    (torch.Tensor(testCoordsA[i][j]['pointC']) - model.lattice[i][j].pointC).norm() < 1e-5
                )
                self.assertTrue(
                    (torch.Tensor(testCoordsA[i][j]['pointP']) - model.lattice[i][j].pointP).norm() < 1e-5
                )
                self.assertTrue(
                    (torch.Tensor(testCoordsA[i][j]['pointPprime']) - model.lattice[i][j].pointPprime).norm() < 1e-5
                )
                self.assertTrue(
                    (torch.Tensor(testCoordsA[i][j]['pointAprime']) - model.lattice[i][j].pointAprime).norm() < 1e-5
                )
                self.assertTrue(
                    (torch.Tensor(testCoordsA[i][j]['pointBprime']) - model.lattice[i][j].pointBprime).norm() < 1e-5
                )

    def test_configB(self):
        model = create_flat_2D_sheet(3,3)
        model.config[0][0]['phi'].data[0] = 0.02
        model.config[1][0]['phiPrime'].data[0] = 0.
        model.config[0][0]['theta'].data[0] = 1.5
        model.config[0][0]['thetaPrime'].data[0] = 1.5
        model.config[2][0]['theta'].data[0] = .75
        model.config[-2][0]['theta'].data[0] = .75
        model.config[-3][0]['theta'].data[0] = .75
        model.forward()
        
        for i in range(3):
            for j in range(3):
                self.assertTrue(
                    (torch.Tensor(testCoordsB[i][j]['pointA']) - model.lattice[i][j].pointA).norm() < 1e-5
                )
                self.assertTrue(
                    (torch.Tensor(testCoordsB[i][j]['pointB']) - model.lattice[i][j].pointB).norm() < 1e-5
                )
                self.assertTrue(
                    (torch.Tensor(testCoordsB[i][j]['pointC']) - model.lattice[i][j].pointC).norm() < 1e-5
                )
                self.assertTrue(
                    (torch.Tensor(testCoordsB[i][j]['pointP']) - model.lattice[i][j].pointP).norm() < 1e-5
                )
                self.assertTrue(
                    (torch.Tensor(testCoordsB[i][j]['pointPprime']) - model.lattice[i][j].pointPprime).norm() < 1e-5
                )
                self.assertTrue(
                    (torch.Tensor(testCoordsB[i][j]['pointAprime']) - model.lattice[i][j].pointAprime).norm() < 1e-5
                )
                self.assertTrue(
                    (torch.Tensor(testCoordsB[i][j]['pointBprime']) - model.lattice[i][j].pointBprime).norm() < 1e-5
                )

    def test_configComplex(self):
        model = Toti2D(testConfig2D)
        model.forward()
        
        for i in range(3):
            for j in range(3):
                self.assertTrue(
                    (torch.Tensor(testConfig2D_points[i][j]['pointA']) - model.lattice[i][j].pointA).norm() < 1e-5
                )
                self.assertTrue(
                    (torch.Tensor(testConfig2D_points[i][j]['pointB']) - model.lattice[i][j].pointB).norm() < 1e-5
                )
                self.assertTrue(
                    (torch.Tensor(testConfig2D_points[i][j]['pointC']) - model.lattice[i][j].pointC).norm() < 1e-5
                )
                self.assertTrue(
                    (torch.Tensor(testConfig2D_points[i][j]['pointP']) - model.lattice[i][j].pointP).norm() < 1e-5
                )
                self.assertTrue(
                    (torch.Tensor(testConfig2D_points[i][j]['pointPprime']) - model.lattice[i][j].pointPprime).norm() < 1e-5
                )
                self.assertTrue(
                    (torch.Tensor(testConfig2D_points[i][j]['pointAprime']) - model.lattice[i][j].pointAprime).norm() < 1e-5
                )
                self.assertTrue(
                    (torch.Tensor(testConfig2D_points[i][j]['pointBprime']) - model.lattice[i][j].pointBprime).norm() < 1e-5
                )  

class Test3DCreation(unittest.TestCase):

    def test_flat_sheet(self):
        for dimx in [2,6,12]:
            for dimy in [2,6,12]:
                model = create_flat_3D_sheet(dimx,dimy)
            forwardworks = model()
            lengthsOk = model._check_lengths()
            self.assertTrue(forwardworks)
            self.assertTrue(lengthsOk)

    def test_configA(self):
        model = create_flat_3D_sheet(5,5)
        
        for i in range(5):
            for j in range(5):
                self.assertTrue(
                    (torch.Tensor(points3D_flat[i][j]['pointA']) - model.lattice[i][j].pointA).norm() < 1e-5
                )
                self.assertTrue(
                    (torch.Tensor(points3D_flat[i][j]['pointB']) - model.lattice[i][j].pointB).norm() < 1e-5
                )
                self.assertTrue(
                    (torch.Tensor(points3D_flat[i][j]['pointC']) - model.lattice[i][j].pointC).norm() < 1e-5
                )
                self.assertTrue(
                    (torch.Tensor(points3D_flat[i][j]['pointP']) - model.lattice[i][j].pointP).norm() < 1e-5
                )
                self.assertTrue(
                    (torch.Tensor(points3D_flat[i][j]['pointPprime']) - model.lattice[i][j].pointPprime).norm() < 1e-5
                )
                self.assertTrue(
                    (torch.Tensor(points3D_flat[i][j]['pointAprime']) - model.lattice[i][j].pointAprime).norm() < 1e-5
                )
                self.assertTrue(
                    (torch.Tensor(points3D_flat[i][j]['pointBprime']) - model.lattice[i][j].pointBprime).norm() < 1e-5
                )

    def test_configB(self):
        model = Toti3D(config_3D)
        model.forward()
        
        for i in range(4):
            for j in range(4):
                self.assertTrue(
                    (torch.Tensor(points3D[i][j]['pointA']) - model.lattice[i][j].pointA).norm() < 1e-5
                )
                self.assertTrue(
                    (torch.Tensor(points3D[i][j]['pointB']) - model.lattice[i][j].pointB).norm() < 1e-5
                )
                self.assertTrue(
                    (torch.Tensor(points3D[i][j]['pointC']) - model.lattice[i][j].pointC).norm() < 1e-5
                )
                self.assertTrue(
                    (torch.Tensor(points3D[i][j]['pointP']) - model.lattice[i][j].pointP).norm() < 1e-5
                )
                self.assertTrue(
                    (torch.Tensor(points3D[i][j]['pointPprime']) - model.lattice[i][j].pointPprime).norm() < 1e-5
                )
                self.assertTrue(
                    (torch.Tensor(points3D[i][j]['pointAprime']) - model.lattice[i][j].pointAprime).norm() < 1e-5
                )
                self.assertTrue(
                    (torch.Tensor(points3D[i][j]['pointBprime']) - model.lattice[i][j].pointBprime).norm() < 1e-5
                )

testCoordsA = [[{'pointA': [0.0, 0.0],
   'pointB': [0.9800665974617004, -0.19866932928562164],
   'pointC': [0.37643226981163025, 0.38758915662765503],
   'pointP': [0.4900332987308502, -0.09933466464281082],
   'pointAprime': [-0.15893638134002686, 0.8863366842269897],
   'pointBprime': [0.8410636186599731, 0.8863366842269897],
   'pointPprime': [0.34106361865997314, 0.8863366842269897]},
  {'pointA': [0.9800665974617004, -0.19866932928562164],
   'pointB': [1.9800665378570557, -0.19866932928562164],
   'pointC': [1.4800665378570557, 0.30133068561553955],
   'pointP': [1.4800665378570557, -0.19866932928562164],
   'pointAprime': [0.8410636186599731, 0.8863366842269897],
   'pointBprime': [1.8173187971115112, 0.6697114706039429],
   'pointPprime': [1.3291912078857422, 0.7780240774154663]},
  {'pointA': [1.9800665378570557, -0.19866932928562164],
   'pointB': [2.9800665378570557, -0.19866932928562164],
   'pointC': [2.4800665378570557, 0.30133068561553955],
   'pointP': [2.4800665378570557, -0.19866932928562164],
   'pointAprime': [1.8173187971115112, 0.6697114706039429],
   'pointBprime': [2.79681396484375, 0.8711839914321899],
   'pointPprime': [2.3070664405822754, 0.7704477310180664]}],
 [{'pointA': [-0.15893638134002686, 0.8863366842269897],
   'pointB': [0.8410636186599731, 0.8863366842269897],
   'pointC': [0.7798548936843872, 1.126049518585205],
   'pointP': [0.34106361865997314, 0.8863366842269897],
   'pointAprime': [0.2798548936843872, 1.626049518585205],
   'pointBprime': [1.2798548936843872, 1.626049518585205],
   'pointPprime': [0.7798548936843872, 1.626049518585205]},
  {'pointA': [0.8410636186599731, 0.8863366842269897],
   'pointB': [1.8173187971115112, 0.6697129607200623],
   'pointC': [1.4375029802322388, 1.2661523818969727],
   'pointP': [1.3291912078857422, 0.7780248522758484],
   'pointAprime': [1.2798548936843872, 1.626049518585205],
   'pointBprime': [2.279813289642334, 1.635115385055542],
   'pointPprime': [1.7798340320587158, 1.6305824518203735]},
  {'pointA': [1.8173187971115112, 0.6697129607200623],
   'pointB': [2.79681396484375, 0.8711806535720825],
   'pointC': [2.2063326835632324, 1.2601943016052246],
   'pointP': [2.3070664405822754, 0.77044677734375],
   'pointAprime': [2.279813289642334, 1.635115385055542],
   'pointBprime': [3.1132254600524902, 1.082453966140747],
   'pointPprime': [2.696519374847412, 1.3587846755981445]}],
 [{'pointA': [0.2798548936843872, 1.626049518585205],
   'pointB': [1.2798548936843872, 1.626049518585205],
   'pointC': [0.9610337615013123, 2.092069149017334],
   'pointP': [0.7798548936843872, 1.626049518585205],
   'pointAprime': [0.46103376150131226, 2.592069149017334],
   'pointBprime': [1.461033821105957, 2.592069149017334],
   'pointPprime': [0.9610337615013123, 2.592069149017334]},
  {'pointA': [1.2798548936843872, 1.626049518585205],
   'pointB': [2.279813289642334, 1.6351712942123413],
   'pointC': [1.775273084640503, 2.130589485168457],
   'pointP': [1.7798340320587158, 1.6306103467941284],
   'pointAprime': [1.461033821105957, 2.592069149017334],
   'pointBprime': [2.4610202312469482, 2.5975403785705566],
   'pointPprime': [1.9610270261764526, 2.5948047637939453]},
  {'pointA': [2.279813289642334, 1.6351712942123413],
   'pointB': [3.1132254600524902, 1.082519292831421],
   'pointC': [2.9728453159332275, 1.775551438331604],
   'pointP': [2.696519374847412, 1.3588453531265259],
   'pointAprime': [2.4610202312469482, 2.5975403785705566],
   'pointBprime': [3.184845209121704, 1.9075565338134766],
   'pointPprime': [2.822932720184326, 2.2525484561920166]}]]

testCoordsB = [[{'pointA': [0.0, 0.0],
   'pointB': [0.9998000264167786, 0.019998665899038315],
   'pointC': [0.8588553667068481, 0.35806694626808167],
   'pointP': [0.4999000132083893, 0.009999332949519157],
   'pointAprime': [0.3234867453575134, 0.856814444065094],
   'pointBprime': [1.3234868049621582, 0.856814444065094],
   'pointPprime': [0.8234867453575134, 0.856814444065094]},
  {'pointA': [0.9998000264167786, 0.019998665899038315],
   'pointB': [1.9997999668121338, 0.019998665899038315],
   'pointC': [1.4997999668121338, 0.5199986696243286],
   'pointP': [1.4997999668121338, 0.019998665899038315],
   'pointAprime': [1.3234868049621582, 0.856814444065094],
   'pointBprime': [2.3192334175109863, 0.948948085308075],
   'pointPprime': [1.8213601112365723, 0.9028812646865845]},
  {'pointA': [1.9997999668121338, 0.019998665899038315],
   'pointB': [2.999799966812134, 0.019998665899038315],
   'pointC': [2.499799966812134, 0.5199986696243286],
   'pointP': [2.499799966812134, 0.019998665899038315],
   'pointAprime': [2.3192334175109863, 0.948948085308075],
   'pointBprime': [3.315563201904297, 0.8633963465690613],
   'pointPprime': [2.8173983097076416, 0.9061722159385681]}],
 [{'pointA': [0.3234867453575134, 0.856814444065094],
   'pointB': [1.3234868049621582, 0.856814444065094],
   'pointC': [1.1893311738967896, 1.1976338624954224],
   'pointP': [0.8234867453575134, 0.856814444065094],
   'pointAprime': [0.6893311738967896, 1.6976338624954224],
   'pointBprime': [1.6893311738967896, 1.6976338624954224],
   'pointPprime': [1.1893311738967896, 1.6976338624954224]},
  {'pointA': [1.3234868049621582, 0.856814444065094],
   'pointB': [2.3192334175109863, 0.9489485025405884],
   'pointC': [1.7752931118011475, 1.4007548093795776],
   'pointP': [1.8213601112365723, 0.9028815031051636],
   'pointAprime': [1.6893311738967896, 1.6976338624954224],
   'pointBprime': [2.6888036727905273, 1.6652647256851196],
   'pointPprime': [2.1890673637390137, 1.681449294090271]},
  {'pointA': [2.3192334175109863, 0.9489485025405884],
   'pointB': [3.315563201904297, 0.8633508086204529],
   'pointC': [2.860197067260742, 1.4043145179748535],
   'pointP': [2.8173983097076416, 0.906149685382843],
   'pointAprime': [2.6888036727905273, 1.6652647256851196],
   'pointBprime': [3.6542539596557617, 1.9258545637130737],
   'pointPprime': [3.1715288162231445, 1.7955596446990967]}],
 [{'pointA': [0.6893311738967896, 1.6976338624954224],
   'pointB': [1.6893311738967896, 1.6976338624954224],
   'pointC': [1.555175542831421, 2.0384533405303955],
   'pointP': [1.1893311738967896, 1.6976338624954224],
   'pointAprime': [1.055175542831421, 2.5384533405303955],
   'pointBprime': [2.055175542831421, 2.5384533405303955],
   'pointPprime': [1.555175542831421, 2.5384533405303955]},
  {'pointA': [1.6893311738967896, 1.6976338624954224],
   'pointB': [2.6888036727905273, 1.6651573181152344],
   'pointC': [2.205305576324463, 2.1811318397521973],
   'pointP': [2.1890673637390137, 1.6813956499099731],
   'pointAprime': [2.055175542831421, 2.5384533405303955],
   'pointBprime': [3.0551865100860596, 2.538208246231079],
   'pointPprime': [2.5551810264587402, 2.5383307933807373]},
  {'pointA': [2.6888036727905273, 1.6651573181152344],
   'pointB': [3.6542539596557617, 1.925744652748108],
   'pointC': [3.0412352085113525, 2.2781760692596436],
   'pointP': [3.1715288162231445, 1.7954509258270264],
   'pointAprime': [3.0551865100860596, 2.538208246231079],
   'pointBprime': [4.005429267883301, 2.2264492511749268],
   'pointPprime': [3.5303080081939697, 2.382328748703003]}]]

testConfig2D = [[{'phi': 0.02966724919666119,
   'phiPrime': -0.015642135197566815,
   'theta': 0.525463148867052,
   'thetaPrime': 0.4784024245212518},
  {'phi': 0.01074746867055739,
   'phiPrime': 0.05782684322734131,
   'theta': 0.522181736262301,
   'thetaPrime': 0.5257734291828476},
  {'phi': 0.013412544451672897,
   'phiPrime': -0.034588455040305,
   'theta': 0.5343874740365907,
   'thetaPrime': 0.44148809796948707},
  {'phi': -0.03908048072994544,
   'phiPrime': 0.008300556957790516,
   'theta': 0.555324849754834,
   'thetaPrime': 0.45343823488683677},
  {'phi': -0.010441182118151555,
   'phiPrime': -0.06094855272837409,
   'theta': 0.5138274662699907,
   'thetaPrime': 0.36765375304164927},
  {'phi': -0.010513752878082941,
   'phiPrime': 0.03584087931792608,
   'theta': 0.5062600340700658,
   'thetaPrime': 0.44883313162093724}],
 [{'phi': -0.015642135197566815,
   'phiPrime': 0.01692518741895044,
   'theta': 0.4563074076296822,
   'thetaPrime': 0.45529403522982465},
  {'phi': 0.05782684322734131,
   'phiPrime': 0.016469527238149234,
   'theta': 0.5207841657216302,
   'thetaPrime': 0.5976526704062647},
  {'phi': -0.034588455040305,
   'phiPrime': 0.021652337627581647,
   'theta': 0.49126029357929624,
   'thetaPrime': 0.48683357208722017},
  {'phi': 0.008300556957790516,
   'phiPrime': -0.04345151483594472,
   'theta': 0.4789961576876029,
   'thetaPrime': 0.4505816221029651},
  {'phi': -0.06094855272837409,
   'phiPrime': -0.025620423774858642,
   'theta': 0.4830621693005115,
   'thetaPrime': 0.4053966194852319},
  {'phi': 0.03584087931792608,
   'phiPrime': 0.012974908381181446,
   'theta': 0.49450603741838167,
   'thetaPrime': 0.5586374156112994}],
 [{'phi': 0.01692518741895044,
   'phiPrime': 0.0055414901845965555,
   'theta': 0.5178333722182031,
   'thetaPrime': 0.527052723614391},
  {'phi': 0.016469527238149234,
   'phiPrime': 0.02727908066814662,
   'theta': 0.4590250260639441,
   'thetaPrime': 0.4891716976220971},
  {'phi': 0.021652337627581647,
   'phiPrime': 0.011250374550508044,
   'theta': 0.45591892164789005,
   'thetaPrime': 0.47502201211903095},
  {'phi': -0.04345151483594472,
   'phiPrime': -0.0562708455002347,
   'theta': 0.4605721398019428,
   'thetaPrime': 0.3450054908273086},
  {'phi': -0.025620423774858642,
   'phiPrime': -0.03700016163392804,
   'theta': 0.40905058096371183,
   'thetaPrime': 0.32655855386243354},
  {'phi': 0.012974908381181446,
   'phiPrime': 0.07408921059080471,
   'theta': 0.508281314718445,
   'thetaPrime': 0.5675727829199962}],
 [{'phi': 0.0055414901845965555,
   'phiPrime': -0.042987901516469335,
   'theta': 0.5941592942642708,
   'thetaPrime': 0.46408703103982213},
  {'phi': 0.02727908066814662,
   'phiPrime': 0.07532895158659203,
   'theta': 0.4728749042079421,
   'thetaPrime': 0.4721262395839179},
  {'phi': 0.011250374550508044,
   'phiPrime': -0.056458471745372336,
   'theta': 0.4574900928299653,
   'thetaPrime': 0.29269199052756234},
  {'phi': -0.0562708455002347,
   'phiPrime': -0.0009829928063978424,
   'theta': 0.5061391017762612,
   'thetaPrime': 0.32693986814559717},
  {'phi': -0.03700016163392804,
   'phiPrime': -0.11613952160489516,
   'theta': 0.47195525718169523,
   'thetaPrime': 0.17734172574038368},
  {'phi': 0.07408921059080471,
   'phiPrime': 0.19287721868055002,
   'theta': 0.4722730507055778,
   'thetaPrime': 0.5384591395283123}],
 [{'phi': -0.042987901516469335,
   'phiPrime': 0.0015934748327868585,
   'theta': 0.5155444240453504,
   'thetaPrime': 0.5155497364147048},
  {'phi': 0.07532895158659203,
   'phiPrime': -0.005459879503287116,
   'theta': 0.5022997386073109,
   'thetaPrime': 0.6283924680028425},
  {'phi': -0.056458471745372336,
   'phiPrime': 0.03964124400399041,
   'theta': 0.44695338767035897,
   'thetaPrime': 0.4965867786580353},
  {'phi': -0.0009829928063978424,
   'phiPrime': -0.0848523412645839,
   'theta': 0.5175024116074206,
   'thetaPrime': 0.48801640906948485},
  {'phi': -0.11613952160489516,
   'phiPrime': -0.05219599258690048,
   'theta': 0.49123676737215505,
   'thetaPrime': 0.3868746642759729},
  {'phi': 0.19287721868055002,
   'phiPrime': -0.04868321206720216,
   'theta': 0.4596346963383585,
   'thetaPrime': 0.7884516143043614}],
 [{'phi': 0.0015934748327868585,
   'phiPrime': -0.02418329742683834,
   'theta': 0.4701203648066667,
   'thetaPrime': 0.5193426922427944},
  {'phi': -0.005459879503287116,
   'phiPrime': 0.016649042633647478,
   'theta': 0.43443968425549245,
   'thetaPrime': 0.5165533568222473},
  {'phi': 0.03964124400399041,
   'phiPrime': -0.05073550367168789,
   'theta': 0.5742345320359774,
   'thetaPrime': 0.6403830548182768},
  {'phi': -0.0848523412645839,
   'phiPrime': 0.07696402298290231,
   'theta': 0.5247320150618976,
   'thetaPrime': 0.5859941446209791},
  {'phi': -0.05219599258690048,
   'phiPrime': -0.22703336306348207,
   'theta': 0.5281361054532412,
   'thetaPrime': 0.24635380533221096},
  {'phi': -0.04868321206720216,
   'phiPrime': 0.060385697708895805,
   'theta': 0.4707380036351128,
   'thetaPrime': 0.39846283911280733}]]

testConfig2D_points = [[{'pointA': [0.0, 0.0],
   'pointB': [0.9956597685813904, 0.09306753426790237],
   'pointC': [0.41166359186172485, 0.539053201675415],
   'pointP': [0.4978298842906952, 0.04653376713395119],
   'pointAprime': [-0.09708711504936218, 1.0635263919830322],
   'pointBprime': [0.9017057418823242, 1.0144050121307373],
   'pointPprime': [0.4023092985153198, 1.0389657020568848]},
  {'pointA': [0.9956597685813904, 0.09306753426790237],
   'pointB': [1.9950897693634033, 0.12682528793811798],
   'pointC': [1.4437419176101685, 0.6072733402252197],
   'pointP': [1.4953747987747192, 0.10994641482830048],
   'pointAprime': [0.9017057418823242, 1.0144050121307373],
   'pointBprime': [1.885249376296997, 1.1950757503509521],
   'pointPprime': [1.3934775590896606, 1.1047403812408447]},
  {'pointA': [1.9950897693634033, 0.12682528793811798],
   'pointB': [2.994202136993408, 0.16894957423210144],
   'pointC': [2.419843912124634, 0.6422603726387024],
   'pointP': [2.4946460723876953, 0.1478874236345291],
   'pointAprime': [1.885249376296997, 1.1950757503509521],
   'pointBprime': [2.8793513774871826, 1.0866217613220215],
   'pointPprime': [2.38230037689209, 1.1408487558364868]},
  {'pointA': [2.994202136993408, 0.16894957423210144],
   'pointB': [3.9866747856140137, 0.046482838690280914],
   'pointC': [3.464932918548584, 0.6070652008056641],
   'pointP': [3.490438461303711, 0.10771620273590088],
   'pointAprime': [2.8793513774871826, 1.0866217613220215],
   'pointBprime': [3.879011392593384, 1.1126923561096191],
   'pointPprime': [3.379181385040283, 1.0996570587158203]},
  {'pointA': [3.9866747856140137, 0.046482838690280914],
   'pointB': [4.9861369132995605, 0.013686779886484146],
   'pointC': [4.481086730957031, 0.5300565361976624],
   'pointP': [4.486405849456787, 0.03008480928838253],
   'pointAprime': [3.879011392593384, 1.1126923561096191],
   'pointBprime': [4.860735893249512, 0.9223694801330566],
   'pointPprime': [4.369873523712158, 1.017530918121338]},
  {'pointA': [4.9861369132995605, 0.013686779886484146],
   'pointB': [5.985591411590576, -0.019337143748998642],
   'pointC': [5.4925456047058105, 0.4971301853656769],
   'pointP': [5.485864162445068, -0.002825181931257248],
   'pointAprime': [4.860735893249512, 0.9223694801330566],
   'pointBprime': [5.854403495788574, 1.0347635746002197],
   'pointPprime': [5.357569694519043, 0.9785665273666382]}],
 [{'pointA': [-0.09708711504936218, 1.0635263919830322],
   'pointB': [0.9017057418823242, 1.0144050121307373],
   'pointC': [0.49497324228286743, 1.5303040742874146],
   'pointP': [0.4023092985153198, 1.0389657020568848],
   'pointAprime': [-0.100526362657547, 1.9943875074386597],
   'pointBprime': [0.8980603218078613, 2.047534465789795],
   'pointPprime': [0.39876699447631836, 2.020961046218872]},
  {'pointA': [0.9017057418823242, 1.0144050121307373],
   'pointB': [1.885249376296997, 1.1950757503509521],
   'pointC': [1.2712470293045044, 1.5895699262619019],
   'pointP': [1.3934775590896606, 1.1047403812408447],
   'pointAprime': [0.8980603218078613, 2.047534465789795],
   'pointBprime': [1.8967220783233643, 2.0992579460144043],
   'pointPprime': [1.3973912000656128, 2.0733962059020996]},
  {'pointA': [1.885249376296997, 1.1950757503509521],
   'pointB': [2.8793513774871826, 1.086626648902893],
   'pointC': [2.4501500129699707, 1.6362261772155762],
   'pointP': [2.38230037689209, 1.1408511400222778],
   'pointAprime': [1.8967220783233643, 2.0992579460144043],
   'pointBprime': [2.894409418106079, 2.16721773147583],
   'pointPprime': [2.3955657482147217, 2.133237838745117]},
  {'pointA': [2.8793513774871826, 1.086626648902893],
   'pointB': [3.879011392593384, 1.1127007007598877],
   'pointC': [3.399130344390869, 1.599265456199646],
   'pointP': [3.379181385040283, 1.0996636152267456],
   'pointAprime': [2.894409418106079, 2.16721773147583],
   'pointBprime': [3.8851068019866943, 2.031137466430664],
   'pointPprime': [3.3897581100463867, 2.099177598953247]},
  {'pointA': [3.879011392593384, 1.1127007007598877],
   'pointB': [4.860735893249512, 0.9223930239677429],
   'pointC': [4.491000175476074, 1.5026534795761108],
   'pointP': [4.369873523712158, 1.0175468921661377],
   'pointAprime': [3.8851068019866943, 2.031137466430664],
   'pointBprime': [4.881869316101074, 1.9507791996002197],
   'pointPprime': [4.383488178253174, 1.990958333015442]},
  {'pointA': [4.860735893249512, 0.9223930239677429],
   'pointB': [5.854403495788574, 1.0347527265548706],
   'pointC': [5.309973239898682, 1.4763022661209106],
   'pointP': [5.357569694519043, 0.9785728454589844],
   'pointAprime': [4.881869316101074, 1.9507791996002197],
   'pointBprime': [5.881038665771484, 1.991553783416748],
   'pointPprime': [5.381453990936279, 1.9711664915084839]}],
 [{'pointA': [-0.100526362657547, 1.9943875074386597],
   'pointB': [0.8980603218078613, 2.047534465789795],
   'pointC': [0.3442768454551697, 2.5179829597473145],
   'pointP': [0.39876699447631836, 2.020961046218872],
   'pointAprime': [-0.12188339233398438, 3.0081374645233154],
   'pointBprime': [0.8779650926589966, 3.025545835494995],
   'pointPprime': [0.3780408501625061, 3.0168416500091553]},
  {'pointA': [0.8980603218078613, 2.047534465789795],
   'pointB': [1.8967220783233643, 2.0992519855499268],
   'pointC': [1.435846209526062, 2.5719120502471924],
   'pointP': [1.3973912000656128, 2.0733931064605713],
   'pointAprime': [0.8779650926589966, 3.025545835494995],
   'pointBprime': [1.8742951154708862, 3.1111209392547607],
   'pointPprime': [1.3761301040649414, 3.068333387374878]},
  {'pointA': [1.8967220783233643, 2.0992519855499268],
   'pointB': [2.894409418106079, 2.167222261428833],
   'pointC': [2.43076753616333, 2.6319963932037354],
   'pointP': [2.3955657482147217, 2.13323712348938],
   'pointAprime': [1.8742951154708862, 3.1111209392547607],
   'pointBprime': [2.8736705780029297, 3.14640212059021],
   'pointPprime': [2.3739829063415527, 3.1287615299224854]},
  {'pointA': [2.894409418106079, 2.167222261428833],
   'pointB': [3.8851068019866943, 2.0311388969421387],
   'pointC': [3.5184786319732666, 2.582327365875244],
   'pointP': [3.3897581100463867, 2.0991804599761963],
   'pointAprime': [2.8736705780029297, 3.14640212059021],
   'pointBprime': [3.8580856323242188, 2.9705402851104736],
   'pointPprime': [3.365878105163574, 3.058471202850342]},
  {'pointA': [3.8851068019866943, 2.0311388969421387],
   'pointB': [4.881869316101074, 1.9507368803024292],
   'pointC': [4.562530040740967, 2.457782506942749],
   'pointP': [4.383488178253174, 1.9909378290176392],
   'pointAprime': [3.8580856323242188, 2.9705402851104736],
   'pointBprime': [4.851337432861328, 2.8545548915863037],
   'pointPprime': [4.354711532592773, 2.9125475883483887]},
  {'pointA': [4.881869316101074, 1.9507368803024292],
   'pointB': [5.881038665771484, 1.9914875030517578],
   'pointC': [5.348089694976807, 2.4699976444244385],
   'pointP': [5.381453990936279, 1.9711121320724487],
   'pointAprime': [4.851337432861328, 2.8545548915863037],
   'pointBprime': [5.824371337890625, 3.085230588912964],
   'pointPprime': [5.337854385375977, 2.969892740249634]}],
 [{'pointA': [-0.12188339233398438, 3.0081374645233154],
   'pointB': [0.8779650926589966, 3.025545597076416],
   'pointC': [0.2239794284105301, 3.4925148487091064],
   'pointP': [0.3780408501625061, 3.0168416500091553],
   'pointAprime': [-0.26035556197166443, 4.059711456298828],
   'pointBprime': [0.7305389642715454, 3.9250712394714355],
   'pointPprime': [0.23509171605110168, 3.992391347885132]},
  {'pointA': [0.8779650926589966, 3.025545597076416],
   'pointB': [1.8742951154708862, 3.111140489578247],
   'pointC': [1.3758882284164429, 3.568343162536621],
   'pointP': [1.3761301040649414, 3.068343162536621],
   'pointAprime': [0.7305389642715454, 3.9250712394714355],
   'pointBprime': [1.7026671171188354, 4.159514904022217],
   'pointPprime': [1.2166030406951904, 4.042293071746826]},
  {'pointA': [1.8742951154708862, 3.111140489578247],
   'pointB': [2.8736705780029297, 3.146477222442627],
   'pointC': [2.423006296157837, 3.6263999938964844],
   'pointP': [2.3739829063415527, 3.1288089752197266],
   'pointAprime': [1.7026671171188354, 4.159514904022217],
   'pointBprime': [2.686978340148926, 3.983076572418213],
   'pointPprime': [2.1948227882385254, 4.071295738220215]},
  {'pointA': [2.8736705780029297, 3.146477222442627],
   'pointB': [3.8580856323242188, 2.970616579055786],
   'pointC': [3.4442996978759766, 3.552358627319336],
   'pointP': [3.365878105163574, 3.058546781539917],
   'pointAprime': [2.686978340148926, 3.983076572418213],
   'pointBprime': [3.6869735717773438, 3.9790406227111816],
   'pointPprime': [3.1869759559631348, 3.9810585975646973]},
  {'pointA': [3.8580856323242188, 2.970616579055786],
   'pointB': [4.851337432861328, 2.8546388149261475],
   'pointC': [4.456174373626709, 3.4022247791290283],
   'pointP': [4.354711532592773, 2.912627696990967],
   'pointAprime': [3.6869735717773438, 3.9790406227111816],
   'pointBprime': [4.621146202087402, 3.622220039367676],
   'pointPprime': [4.154059886932373, 3.8006303310394287]},
  {'pointA': [4.851337432861328, 2.8546388149261475],
   'pointB': [5.824371337890625, 3.085300922393799],
   'pointC': [5.265285968780518, 3.4646759033203125],
   'pointP': [5.337854385375977, 2.9699699878692627],
   'pointAprime': [4.621146202087402, 3.622220039367676],
   'pointBprime': [5.443112373352051, 4.191752910614014],
   'pointPprime': [5.032129287719727, 3.9069864749908447]}],
 [{'pointA': [-0.26035556197166443, 4.059711456298828],
   'pointB': [0.7305389642715454, 3.9250712394714355],
   'pointC': [0.2781464755535126, 4.49053430557251],
   'pointP': [0.23509171605110168, 3.992391347885132],
   'pointAprime': [-0.19993188977241516, 4.987550735473633],
   'pointBprime': [0.8000556230545044, 4.992556571960449],
   'pointPprime': [0.3000618517398834, 4.990053653717041]},
  {'pointA': [0.7305389642715454, 3.9250712394714355],
   'pointB': [1.7026671171188354, 4.159521579742432],
   'pointC': [1.0958693027496338, 4.527501106262207],
   'pointP': [1.2166030406951904, 4.042296409606934],
   'pointAprime': [0.8000556230545044, 4.992556571960449],
   'pointBprime': [1.7999085187911987, 4.975327491760254],
   'pointPprime': [1.2999820709228516, 4.983942031860352]},
  {'pointA': [1.7026671171188354, 4.159521579742432],
   'pointB': [2.686978340148926, 3.9830806255340576],
   'pointC': [2.363460063934326, 4.542004108428955],
   'pointP': [2.1948227882385254, 4.071300983428955],
   'pointAprime': [1.7999085187911987, 4.975327491760254],
   'pointBprime': [2.792163848876953, 5.099547386169434],
   'pointPprime': [2.2960362434387207, 5.037437438964844]},
  {'pointA': [2.686978340148926, 3.9830806255340576],
   'pointB': [3.6869735717773438, 3.979992389678955],
   'pointC': [3.161038875579834, 4.480863571166992],
   'pointP': [3.1869759559631348, 3.981536626815796],
   'pointAprime': [2.792163848876953, 5.099547386169434],
   'pointBprime': [3.7568435668945312, 4.836092948913574],
   'pointPprime': [3.274503707885742, 4.967820167541504]},
  {'pointA': [3.6869735717773438, 3.979992389678955],
   'pointB': [4.621146202087402, 3.623171091079712],
   'pointC': [4.3452606201171875, 4.263579845428467],
   'pointP': [4.154059886932373, 3.801581621170044],
   'pointAprime': [3.7568435668945312, 4.836092948913574],
   'pointBprime': [4.743429183959961, 4.6728010177612305],
   'pointPprime': [4.250136375427246, 4.754446983337402]},
  {'pointA': [4.621146202087402, 3.623171091079712],
   'pointB': [5.443112373352051, 4.192707538604736],
   'pointC': [4.8016252517700195, 4.351637363433838],
   'pointP': [5.032129287719727, 3.9079391956329346],
   'pointAprime': [4.743429183959961, 4.6728010177612305],
   'pointBprime': [5.731756210327148, 4.520173072814941],
   'pointPprime': [5.237592697143555, 4.596487045288086]}],
 [{'pointA': [-0.19993188977241516, 4.987550735473633],
   'pointB': [0.8000556230545044, 4.992556571960449],
   'pointC': [0.3444351851940155, 5.488080978393555],
   'pointP': [0.3000618517398834, 4.990053653717041],
   'pointAprime': [-0.08596491813659668, 6.021364212036133],
   'pointBprime': [0.9111504554748535, 5.945463180541992],
   'pointPprime': [0.4125927686691284, 5.9834136962890625]},
  {'pointA': [0.8000556230545044, 4.992556571960449],
   'pointB': [1.7999085187911987, 4.975404739379883],
   'pointC': [1.4106169939041138, 5.471587181091309],
   'pointP': [1.2999820709228516, 4.983980655670166],
   'pointAprime': [0.9111504554748535, 5.945463180541992],
   'pointBprime': [1.909782886505127, 5.997711181640625],
   'pointPprime': [1.4104666709899902, 5.971587181091309]},
  {'pointA': [1.7999085187911987, 4.975404739379883],
   'pointB': [2.792163848876953, 5.0996198654174805],
   'pointC': [2.1209518909454346, 5.505855560302734],
   'pointP': [2.2960362434387207, 5.037512302398682],
   'pointAprime': [1.909782886505127, 5.997711181640625],
   'pointBprime': [2.8971071243286133, 5.839089393615723],
   'pointPprime': [2.40344500541687, 5.918400287628174]},
  {'pointA': [2.792163848876953, 5.0996198654174805],
   'pointB': [3.7568435668945312, 4.836194038391113],
   'pointC': [3.368380069732666, 5.459014892578125],
   'pointP': [3.274503707885742, 4.967906951904297],
   'pointAprime': [2.8971071243286133, 5.839089393615723],
   'pointBprime': [3.86801815032959, 6.078537940979004],
   'pointPprime': [3.3825626373291016, 5.958813667297363]},
  {'pointA': [3.7568435668945312, 4.836194038391113],
   'pointB': [4.743429183959961, 4.672949314117432],
   'pointC': [4.287893772125244, 5.253144264221191],
   'pointP': [4.250136375427246, 4.754571914672852],
   'pointAprime': [3.86801815032959, 6.078537940979004],
   'pointBprime': [4.624259948730469, 5.424258232116699],
   'pointPprime': [4.246139049530029, 5.751398086547852]},
  {'pointA': [4.743429183959961, 4.672949314117432],
   'pointB': [5.731756210327148, 4.520602226257324],
   'pointC': [5.358808994293213, 5.081859588623047],
   'pointP': [5.237592697143555, 4.596775531768799],
   'pointAprime': [4.624259948730469, 5.424258232116699],
   'pointBprime': [5.606319427490234, 5.612839698791504],
   'pointPprime': [5.115289688110352, 5.518548965454102]}]]

points3D_flat = [[{'pointA': [0.0, 0.0, 0.0],
   'pointB': [1.0, 0.0, 0.0],
   'pointC': [0.4999999701976776, 0.5, 0.0],
   'pointP': [0.5, 0.0, 0.0],
   'pointAprime': [0.0, 1.0, 0.0],
   'pointBprime': [1.0, 1.0, 0.0],
   'pointPprime': [0.5, 1.0, 0.0]},
  {'pointA': [1.0, 0.0, 0.0],
   'pointB': [2.0, 0.0, 0.0],
   'pointC': [1.5, 0.5, 0.0],
   'pointP': [1.5, 0.0, 0.0],
   'pointAprime': [1.0, 1.0, 0.0],
   'pointBprime': [2.0, 1.0, -4.371138828673793e-08],
   'pointPprime': [1.5, 1.0, -2.1855694143368964e-08]},
  {'pointA': [2.0, 0.0, 0.0],
   'pointB': [3.0, 0.0, 0.0],
   'pointC': [2.5, 0.5, 0.0],
   'pointP': [2.5, 0.0, 0.0],
   'pointAprime': [2.0, 1.0, -4.371138828673793e-08],
   'pointBprime': [3.0, 1.0, -8.742277657347586e-08],
   'pointPprime': [2.5, 1.0, -6.556707887739321e-08]},
  {'pointA': [3.0, 0.0, 0.0],
   'pointB': [4.0, 0.0, 0.0],
   'pointC': [3.5, 0.5, 0.0],
   'pointP': [3.5, 0.0, 0.0],
   'pointAprime': [3.0, 1.0, -8.742277657347586e-08],
   'pointBprime': [4.0, 1.0, -1.3113415775478643e-07],
   'pointPprime': [3.5, 1.0, -1.092784742695585e-07]},
  {'pointA': [4.0, 0.0, 0.0],
   'pointB': [5.0, 0.0, 0.0],
   'pointC': [4.5, 0.5, 0.0],
   'pointP': [4.5, 0.0, 0.0],
   'pointAprime': [4.0, 1.0, -1.3113415775478643e-07],
   'pointBprime': [5.0, 1.0, -1.7484555314695172e-07],
   'pointPprime': [4.5, 1.0, -1.5298985545086907e-07]}],
 [{'pointA': [0.0, 1.0, 0.0],
   'pointB': [1.0, 1.0, 0.0],
   'pointC': [0.4999999701976776, 1.5, 0.0],
   'pointP': [0.5, 1.0, 0.0],
   'pointAprime': [0.0, 2.0, 0.0],
   'pointBprime': [1.0, 2.0, 0.0],
   'pointPprime': [0.5, 2.0, 0.0]},
  {'pointA': [1.0, 1.0, 0.0],
   'pointB': [2.0, 1.0, -4.371138828673793e-08],
   'pointC': [1.5, 1.5, -2.1845021791477848e-08],
   'pointP': [1.5, 1.0, -2.1855694143368964e-08],
   'pointAprime': [1.0, 2.0, 0.0],
   'pointBprime': [2.0, 2.0, -4.371138828673793e-08],
   'pointPprime': [1.5, 2.0, -2.1855694143368964e-08]},
  {'pointA': [2.0, 1.0, -4.371138828673793e-08],
   'pointB': [3.0, 1.0, -8.742277657347586e-08],
   'pointC': [2.5, 1.5, -6.55564065255021e-08],
   'pointP': [2.5, 1.0, -6.556707887739321e-08],
   'pointAprime': [2.0, 2.0, -4.371138828673793e-08],
   'pointBprime': [3.0, 2.0, -8.742277657347586e-08],
   'pointPprime': [2.5, 2.0, -6.556707887739321e-08]},
  {'pointA': [3.0, 1.0, -8.742277657347586e-08],
   'pointB': [4.0, 1.0, -1.3113415775478643e-07],
   'pointC': [3.5, 1.5, -1.0926779481224003e-07],
   'pointP': [3.5, 1.0, -1.0927846716413114e-07],
   'pointAprime': [3.0, 2.0, -8.742277657347586e-08],
   'pointBprime': [4.0, 2.0, -1.3113415775478643e-07],
   'pointPprime': [3.5, 2.0, -1.092784742695585e-07]},
  {'pointA': [4.0, 1.0, -1.3113415775478643e-07],
   'pointB': [5.0, 1.0, -1.7484555314695172e-07],
   'pointC': [4.5, 1.5, -1.5297918309897796e-07],
   'pointP': [4.5, 1.0, -1.5298985545086907e-07],
   'pointAprime': [4.0, 2.0, -1.3113415775478643e-07],
   'pointBprime': [5.0, 2.0, -1.7484555314695172e-07],
   'pointPprime': [4.5, 2.0, -1.5298985545086907e-07]}],
 [{'pointA': [0.0, 2.0, 0.0],
   'pointB': [1.0, 2.0, 0.0],
   'pointC': [0.4999999701976776, 2.5, 0.0],
   'pointP': [0.5, 2.0, 0.0],
   'pointAprime': [0.0, 3.0, 0.0],
   'pointBprime': [1.0, 3.0, 0.0],
   'pointPprime': [0.5, 3.0, 0.0]},
  {'pointA': [1.0, 2.0, 0.0],
   'pointB': [2.0, 2.0, -4.371138828673793e-08],
   'pointC': [1.5, 2.5, -2.1845021791477848e-08],
   'pointP': [1.5, 2.0, -2.1855694143368964e-08],
   'pointAprime': [1.0, 3.0, 0.0],
   'pointBprime': [2.0, 3.0, -4.371138828673793e-08],
   'pointPprime': [1.5, 3.0, -2.1855694143368964e-08]},
  {'pointA': [2.0, 2.0, -4.371138828673793e-08],
   'pointB': [3.0, 2.0, -8.742277657347586e-08],
   'pointC': [2.5, 2.5, -6.55564065255021e-08],
   'pointP': [2.5, 2.0, -6.556707887739321e-08],
   'pointAprime': [2.0, 3.0, -4.371138828673793e-08],
   'pointBprime': [3.0, 3.0, -8.742277657347586e-08],
   'pointPprime': [2.5, 3.0, -6.556707887739321e-08]},
  {'pointA': [3.0, 2.0, -8.742277657347586e-08],
   'pointB': [4.0, 2.0, -1.3113415775478643e-07],
   'pointC': [3.5, 2.5, -1.0926779481224003e-07],
   'pointP': [3.5, 2.0, -1.0927846716413114e-07],
   'pointAprime': [3.0, 3.0, -8.742277657347586e-08],
   'pointBprime': [4.0, 3.0, -1.3113415775478643e-07],
   'pointPprime': [3.5, 3.0, -1.092784742695585e-07]},
  {'pointA': [4.0, 2.0, -1.3113415775478643e-07],
   'pointB': [5.0, 2.0, -1.7484555314695172e-07],
   'pointC': [4.5, 2.5, -1.5297918309897796e-07],
   'pointP': [4.5, 2.0, -1.5298985545086907e-07],
   'pointAprime': [4.0, 3.0, -1.3113415775478643e-07],
   'pointBprime': [5.0, 3.0, -1.7484555314695172e-07],
   'pointPprime': [4.5, 3.0, -1.5298985545086907e-07]}],
 [{'pointA': [0.0, 3.0, 0.0],
   'pointB': [1.0, 3.0, 0.0],
   'pointC': [0.4999999701976776, 3.5, 0.0],
   'pointP': [0.5, 3.0, 0.0],
   'pointAprime': [0.0, 4.0, 0.0],
   'pointBprime': [1.0, 4.0, 0.0],
   'pointPprime': [0.5, 4.0, 0.0]},
  {'pointA': [1.0, 3.0, 0.0],
   'pointB': [2.0, 3.0, -4.371138828673793e-08],
   'pointC': [1.5, 3.5, -2.1845021791477848e-08],
   'pointP': [1.5, 3.0, -2.1855694143368964e-08],
   'pointAprime': [1.0, 4.0, 0.0],
   'pointBprime': [2.0, 4.0, -4.371138828673793e-08],
   'pointPprime': [1.5, 4.0, -2.1855694143368964e-08]},
  {'pointA': [2.0, 3.0, -4.371138828673793e-08],
   'pointB': [3.0, 3.0, -8.742277657347586e-08],
   'pointC': [2.5, 3.5, -6.55564065255021e-08],
   'pointP': [2.5, 3.0, -6.556707887739321e-08],
   'pointAprime': [2.0, 4.0, -4.371138828673793e-08],
   'pointBprime': [3.0, 4.0, -8.742277657347586e-08],
   'pointPprime': [2.5, 4.0, -6.556707887739321e-08]},
  {'pointA': [3.0, 3.0, -8.742277657347586e-08],
   'pointB': [4.0, 3.0, -1.3113415775478643e-07],
   'pointC': [3.5, 3.5, -1.0926779481224003e-07],
   'pointP': [3.5, 3.0, -1.0927846716413114e-07],
   'pointAprime': [3.0, 4.0, -8.742277657347586e-08],
   'pointBprime': [4.0, 4.0, -1.3113415775478643e-07],
   'pointPprime': [3.5, 4.0, -1.092784742695585e-07]},
  {'pointA': [4.0, 3.0, -1.3113415775478643e-07],
   'pointB': [5.0, 3.0, -1.7484555314695172e-07],
   'pointC': [4.5, 3.5, -1.5297918309897796e-07],
   'pointP': [4.5, 3.0, -1.5298985545086907e-07],
   'pointAprime': [4.0, 4.0, -1.3113415775478643e-07],
   'pointBprime': [5.0, 4.0, -1.7484555314695172e-07],
   'pointPprime': [4.5, 4.0, -1.5298985545086907e-07]}],
 [{'pointA': [0.0, 4.0, 0.0],
   'pointB': [1.0, 4.0, 0.0],
   'pointC': [0.4999999701976776, 4.5, 0.0],
   'pointP': [0.5, 4.0, 0.0],
   'pointAprime': [0.0, 5.0, 0.0],
   'pointBprime': [1.0, 5.0, 0.0],
   'pointPprime': [0.5, 5.0, 0.0]},
  {'pointA': [1.0, 4.0, 0.0],
   'pointB': [2.0, 4.0, -4.371138828673793e-08],
   'pointC': [1.5, 4.5, -2.1845021791477848e-08],
   'pointP': [1.5, 4.0, -2.1855694143368964e-08],
   'pointAprime': [1.0, 5.0, 0.0],
   'pointBprime': [2.0, 5.0, -4.371138828673793e-08],
   'pointPprime': [1.5, 5.0, -2.1855694143368964e-08]},
  {'pointA': [2.0, 4.0, -4.371138828673793e-08],
   'pointB': [3.0, 4.0, -8.742277657347586e-08],
   'pointC': [2.5, 4.5, -6.55564065255021e-08],
   'pointP': [2.5, 4.0, -6.556707887739321e-08],
   'pointAprime': [2.0, 5.0, -4.371138828673793e-08],
   'pointBprime': [3.0, 5.0, -8.742277657347586e-08],
   'pointPprime': [2.5, 5.0, -6.556707887739321e-08]},
  {'pointA': [3.0, 4.0, -8.742277657347586e-08],
   'pointB': [4.0, 4.0, -1.3113415775478643e-07],
   'pointC': [3.5, 4.5, -1.0926779481224003e-07],
   'pointP': [3.5, 4.0, -1.0927846716413114e-07],
   'pointAprime': [3.0, 5.0, -8.742277657347586e-08],
   'pointBprime': [4.0, 5.0, -1.3113415775478643e-07],
   'pointPprime': [3.5, 5.0, -1.092784742695585e-07]},
  {'pointA': [4.0, 4.0, -1.3113415775478643e-07],
   'pointB': [5.0, 4.0, -1.7484555314695172e-07],
   'pointC': [4.5, 4.5, -1.5297918309897796e-07],
   'pointP': [4.5, 4.0, -1.5298985545086907e-07],
   'pointAprime': [4.0, 5.0, -1.3113415775478643e-07],
   'pointBprime': [5.0, 5.0, -1.7484555314695172e-07],
   'pointPprime': [4.5, 5.0, -1.5298985545086907e-07]}]]

config_3D = [[{'phiz': 0.02966724919666119,
   'phizPrime': -0.017998002623131535,
   'phiy': -0.015642135197566815,
   'phiyPrime': 0.01074746867055739,
   'thetaz': 0.5147878288127898,
   'thetazPrime': 0.5049691662624288,
   'thetax': 0.01697542488325196,
   'thetaxPrime': 0.015265907982378741},
  {'phiz': 0.013412544451672897,
   'phizPrime': 0.053562281809809986,
   'phiy': 0.0004843219624154676,
   'phiyPrime': 0.015547516919017712,
   'thetaz': 0.5368832631048088,
   'thetazPrime': 0.5153274517027162,
   'thetax': 0.022924977367871198},
  {'phiz': -0.010441182118151555,
   'phizPrime': -0.05488478193104063,
   'phiy': -0.0144052069116252,
   'phiyPrime': 0.01161806047184341,
   'thetaz': 0.5041733733331315,
   'thetazPrime': 0.511445855197398,
   'thetax': 0.009218295444198952},
  {'phiz': -0.004971854779410954,
   'phizPrime': 0.04537938316105006,
   'phiy': 0.01692518741895044,
   'phiyPrime': 0.005748693340863066,
   'thetaz': 0.5138561151190093,
   'thetazPrime': 0.505690320402296,
   'thetax': -0.029128401817796804}],
 [{'phiz': -0.017998002623131535,
   'phizPrime': -0.017998002623131535,
   'phiy': 0.01074746867055739,
   'phiyPrime': 0.01074746867055739,
   'thetaz': 0.4859974430963245,
   'thetazPrime': 0.5049691662624288,
   'thetax': -0.0058264685626463935,
   'thetaxPrime': 0.015265907982378741},
  {'phiz': 0.053562281809809986,
   'phizPrime': 0.03288650707996514,
   'phiy': 0.015547516919017712,
   'phiyPrime': 0.024381645646016817,
   'thetaz': 0.49633736291684366,
   'thetazPrime': 0.5242514353627964,
   'thetax': -0.011291907081007992},
  {'phiz': -0.05488478193104063,
   'phizPrime': -0.022337640389086647,
   'phiy': 0.01161806047184341,
   'phiyPrime': -0.04172499953893398,
   'thetaz': 0.4726833553472186,
   'thetazPrime': 0.4583782830405347,
   'thetax': 0.011888916603726535},
  {'phiz': 0.04537938316105006,
   'phizPrime': -0.0063833299725483215,
   'phiy': 0.005748693340863066,
   'phiyPrime': -0.002769449312920581,
   'thetaz': 0.47371475185738593,
   'thetazPrime': 0.4972307896057767,
   'thetax': -0.02938738456701338}],
 [{'phiz': -0.017998002623131535,
   'phizPrime': -0.017998002623131535,
   'phiy': 0.01074746867055739,
   'phiyPrime': 0.01074746867055739,
   'thetaz': 0.5055208937653843,
   'thetazPrime': 0.5049691662624288,
   'thetax': -0.06063295530003719,
   'thetaxPrime': 0.015265907982378741},
  {'phiz': 0.03288650707996514,
   'phizPrime': 0.015866223506383045,
   'phiy': 0.024381645646016817,
   'phiyPrime': -0.020463289442040514,
   'thetaz': 0.48191659479471877,
   'thetazPrime': 0.4795622285878154,
   'thetax': 0.06277284882381526},
  {'phiz': -0.022337640389086647,
   'phizPrime': 0.016545356567497147,
   'phiy': -0.04172499953893398,
   'phiyPrime': 0.001076814748329846,
   'thetaz': 0.5040927391554301,
   'thetazPrime': 0.5010751615801183,
   'thetax': -0.02833995371345077},
  {'phiz': -0.0063833299725483215,
   'phizPrime': -0.04910369084479414,
   'phiy': -0.002769449312920581,
   'phiyPrime': -0.005717088300594256,
   'thetaz': 0.4815153591264759,
   'thetazPrime': 0.49435080239674545,
   'thetax': -0.0186965068596417}],
 [{'phiz': -0.017998002623131535,
   'phizPrime': -0.017998002623131535,
   'phiy': 0.01074746867055739,
   'phiyPrime': 0.01074746867055739,
   'thetaz': 0.5015331637094631,
   'thetazPrime': 0.5049691662624288,
   'thetax': 0.010362940878252982,
   'thetaxPrime': 0.015265907982378741},
  {'phiz': 0.015866223506383045,
   'phizPrime': 0.007275493195064599,
   'phiy': -0.020463289442040514,
   'phiyPrime': 0.032967895424387536,
   'thetaz': 0.5116682537458727,
   'thetazPrime': 0.5329593194266364,
   'thetax': -0.03536440721870076},
  {'phiz': 0.016545356567497147,
   'phizPrime': 0.026102979011313504,
   'phiy': 0.001076814748329846,
   'phiyPrime': -0.03434142749372941,
   'thetaz': 0.47308978954832975,
   'thetazPrime': 0.46577442927427376,
   'thetax': -0.005842167918465211},
  {'phiz': -0.04910369084479414,
   'phizPrime': -0.08531025801656401,
   'phiy': -0.005717088300594256,
   'phiyPrime': 0.061177326120074135,
   'thetaz': 0.45629314012341593,
   'thetazPrime': 0.5589675034756879,
   'thetax': -0.019919762909275978}]]

points3D = [[{'pointA': [0.0, 0.0, 0.0],
   'pointB': [0.9944578409194946, 0.09306753426790237, 0.04890824109315872],
   'pointC': [0.4264680743217468, 0.5409584641456604, 0.047629762440919876],
   'pointP': [0.4972289204597473, 0.04653376713395119, 0.02445412054657936],
   'pointAprime': [-0.037265002727508545,
    1.0673396587371826,
    0.03931208699941635],
   'pointBprime': [0.960567831993103,
    1.0108273029327393,
    0.005608284845948219],
   'pointPprime': [0.46165141463279724,
    1.039083480834961,
    0.02246018685400486]},
  {'pointA': [0.9944578409194946, 0.09306753426790237, 0.04890824109315872],
   'pointB': [1.9935691356658936, 0.13519181311130524, 0.04738805070519447],
   'pointC': [1.4154460430145264, 0.6066145896911621, 0.08400580286979675],
   'pointP': [1.4940134286880493, 0.1141296774148941, 0.04814814403653145],
   'pointAprime': [0.960567831993103,
    1.0108273029327393,
    0.005608284845948219],
   'pointBprime': [1.945267915725708,
    1.1783051490783691,
    -0.04252571612596512],
   'pointPprime': [1.4529178142547607,
    1.0945662260055542,
    -0.018458716571331024]},
  {'pointA': [1.9935691356658936, 0.13519181311130524, 0.04738805070519447],
   'pointB': [2.9920079708099365, 0.10239575803279877, 0.09260356426239014],
   'pointC': [2.5019614696502686, 0.6184873580932617, 0.08490284532308578],
   'pointP': [2.492788553237915, 0.118793785572052, 0.06999580562114716],
   'pointAprime': [1.945267915725708,
    1.1783051490783691,
    -0.04252571612596512],
   'pointBprime': [2.929783344268799, 1.006732702255249, -0.078476183116436],
   'pointPprime': [2.437525510787964,
    1.092518925666809,
    -0.06050094962120056]},
  {'pointA': [2.9920079708099365, 0.10239575803279877, 0.09260356426239014],
   'pointB': [3.9904727935791016, 0.08677685260772705, 0.03946305811405182],
   'pointC': [3.4748480319976807, 0.5923017263412476, 0.021193481981754303],
   'pointP': [3.4912405014038086, 0.09458630532026291, 0.06603331118822098],
   'pointAprime': [2.929783344268799, 1.006732702255249, -0.078476183116436],
   'pointBprime': [3.9194769859313965,
    1.1488138437271118,
    -0.09635189920663834],
   'pointPprime': [3.4246301651000977,
    1.0777732133865356,
    -0.08741404116153717]}],
 [{'pointA': [-0.037265002727508545, 1.0673396587371826, 0.03931208699941635],
   'pointB': [0.960567831993103, 1.0108274221420288, 0.00560828298330307],
   'pointC': [0.5114911794662476, 1.5364753007888794, 0.011628703214228153],
   'pointP': [0.46165141463279724, 1.039083480834961, 0.02246018499135971],
   'pointAprime': [0.047758132219314575,
    2.062856435775757,
    0.0033110296353697777],
   'pointBprime': [1.0455909967422485,
    2.0063440799713135,
    -0.03039277344942093],
   'pointPprime': [0.5466745495796204,
    2.034600257873535,
    -0.013540872372686863]},
  {'pointA': [0.960567831993103, 1.0108274221420288, 0.00560828298330307],
   'pointB': [1.945267915725708, 1.1783052682876587, -0.04252665489912033],
   'pointC': [1.374136209487915, 1.5881249904632568, -0.03236168622970581],
   'pointP': [1.4529178142547607, 1.0945663452148438, -0.01845918595790863],
   'pointAprime': [1.0455909967422485,
    2.0063440799713135,
    -0.03039277344942093],
   'pointBprime': [2.037342071533203, 2.109476327896118, -0.10650721937417984],
   'pointPprime': [1.5414665937423706,
    2.057910203933716,
    -0.06844999641180038]},
  {'pointA': [1.945267915725708, 1.1783052682876587, -0.04252665489912033],
   'pointB': [2.929783344268799, 1.006732702255249, -0.07847665250301361],
   'pointC': [2.565751075744629, 1.575596809387207, -0.046569451689720154],
   'pointP': [2.437525510787964, 1.0925190448760986, -0.06050165742635727],
   'pointAprime': [2.037342071533203, 2.109476327896118, -0.10650721937417984],
   'pointBprime': [3.026322841644287, 2.039358139038086, 0.023878969252109528],
   'pointPprime': [2.531832456588745,
    2.0744173526763916,
    -0.041314125061035156]},
  {'pointA': [2.929783344268799, 1.006732702255249, -0.07847665250301361],
   'pointB': [3.9194769859313965, 1.1488138437271118, -0.09635251760482788],
   'pointC': [3.394131898880005, 1.5747733116149902, -0.13281019032001495],
   'pointP': [3.4246301651000977, 1.0777732133865356, -0.08741458505392075],
   'pointAprime': [3.026322841644287, 2.039358139038086, 0.023878969252109528],
   'pointBprime': [4.026083946228027, 2.01930570602417, 0.032578591257333755],
   'pointPprime': [3.5262033939361572,
    2.029331922531128,
    0.02822878025472164]}],
 [{'pointA': [0.047758132219314575, 2.062856435775757, 0.0033110296353697777],
   'pointB': [1.0455909967422485, 2.0063440799713135, -0.03039277344942093],
   'pointC': [0.5625513792037964, 2.525188446044922, -0.10878399014472961],
   'pointP': [0.5466745495796204, 2.034600257873535, -0.013540872372686863],
   'pointAprime': [0.0988183319568634,
    3.051569700241089,
    -0.11710166931152344],
   'pointBprime': [1.0966511964797974,
    2.9950573444366455,
    -0.15080547332763672],
   'pointPprime': [0.5977347493171692,
    3.023313522338867,
    -0.13395357131958008]},
  {'pointA': [1.0455909967422485, 2.0063440799713135, -0.03039277344942093],
   'pointB': [2.037342071533203, 2.109476327896118, -0.10650704801082611],
   'pointC': [1.5267698764801025, 2.547745704650879, 0.030773073434829712],
   'pointP': [1.5414665937423706, 2.057910203933716, -0.06844991445541382],
   'pointAprime': [1.0966511964797974,
    2.9950573444366455,
    -0.15080547332763672],
   'pointBprime': [2.093346118927002, 3.044881820678711, -0.08664242923259735],
   'pointPprime': [1.5949985980987549,
    3.0199697017669678,
    -0.11872395128011703]},
  {'pointA': [2.037342071533203, 2.109476327896118, -0.10650704801082611],
   'pointB': [3.026322841644287, 2.039358139038086, 0.02387911081314087],
   'pointC': [2.5659029483795166, 2.5716209411621094, -0.0816606655716896],
   'pointP': [2.531832456588745, 2.0744173526763916, -0.04131396859884262],
   'pointAprime': [2.093346118927002, 3.044881820678711, -0.08664242923259735],
   'pointBprime': [3.091989755630493, 3.096837282180786, -0.09002014249563217],
   'pointPprime': [2.592668056488037,
    3.070859432220459,
    -0.08833128213882446]},
  {'pointA': [3.026322841644287, 2.039358139038086, 0.02387911081314087],
   'pointB': [4.026083946228027, 2.01930570602417, 0.03257773444056511],
   'pointC': [3.565462350845337, 2.5269460678100586, -0.0007331483066082001],
   'pointP': [3.5262033939361572, 2.029331922531128, 0.02822842262685299],
   'pointAprime': [3.091989755630493, 3.096837282180786, -0.09002014249563217],
   'pointBprime': [4.079955101013184,
    2.9431846141815186,
    -0.07227359712123871],
   'pointPprime': [3.585972547531128,
    3.0200109481811523,
    -0.08114686608314514]}],
 [{'pointA': [0.0988183319568634, 3.051569700241089, -0.11710166931152344],
   'pointB': [1.0966511964797974, 2.9950573444366455, -0.15080547332763672],
   'pointC': [0.6241058111190796, 3.5223803520202637, -0.11856002360582352],
   'pointP': [0.5977347493171692, 3.023313522338867, -0.13395357131958008],
   'pointAprime': [0.1603727638721466,
    4.048761367797852,
    -0.12687769532203674],
   'pointBprime': [1.1582056283950806,
    3.9922492504119873,
    -0.16058149933815002],
   'pointPprime': [0.6592891812324524,
    4.020505428314209,
    -0.14372959733009338]},
  {'pointA': [1.0966511964797974, 2.9950573444366455, -0.15080547332763672],
   'pointB': [2.093346118927002, 3.044881820678711, -0.08664222061634064],
   'pointC': [1.5556029081344604, 3.5150234699249268, -0.17677348852157593],
   'pointP': [1.5949985980987549, 3.0199697017669678, -0.11872384697198868],
   'pointAprime': [1.1582056283950806,
    3.9922492504119873,
    -0.16058149933815002],
   'pointBprime': [2.1525869369506836,
    4.015103816986084,
    -0.26394131779670715],
   'pointPprime': [1.6553963422775269,
    4.003676414489746,
    -0.2122614085674286]},
  {'pointA': [2.093346118927002, 3.044881820678711, -0.08664222061634064],
   'pointB': [3.091989755630493, 3.096837282180786, -0.0900205597281456],
   'pointC': [2.608919620513916, 3.5705106258392334, -0.09752998501062393],
   'pointP': [2.592668056488037, 3.070859432220459, -0.08833138644695282],
   'pointAprime': [2.1525869369506836,
    4.015103816986084,
    -0.26394131779670715],
   'pointBprime': [3.1434316635131836, 4.09701681137085, -0.15662556886672974],
   'pointPprime': [2.6480093002319336,
    4.056060314178467,
    -0.21028344333171844]},
  {'pointA': [3.091989755630493, 3.096837282180786, -0.0900205597281456],
   'pointB': [4.079955101013184, 2.9431846141815186, -0.07227403670549393],
   'pointC': [3.730086326599121, 3.4979493618011475, -0.10953878611326218],
   'pointP': [3.585972547531128, 3.0200109481811523, -0.08114729821681976],
   'pointAprime': [3.1434316635131836, 4.09701681137085, -0.15662556886672974],
   'pointBprime': [4.0899763107299805,
    3.8322036266326904,
    -0.34081965684890747],
   'pointPprime': [3.616703987121582,
    3.9646103382110596,
    -0.2487226128578186]}]]

if __name__ == '__main__':
    unittest.main()